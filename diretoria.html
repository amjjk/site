<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Nossa Diretoria - A.M.J.J.K</title>
    
    <meta name="description" content="Site da Associação de Moradores do Jardim John Kennedy, Ibiporã-PR.">
    <link rel="icon" type="image/png" href="img/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="shortcut icon" href="img/favicon/favicon.ico" />

    <link href="css/owl.carousel.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body>
    <div class="preloader d-flex align-items-center justify-content-center">
        <div class="lds-ellipsis">
            <div></div><div></div><div></div><div></div>
        </div>
    </div>

    <header class="header-area">
        <div class="top-header-area">
            <div class="container h-100">
                <div class="row h-100 align-items-center">
                    <div class="col-12 d-flex justify-content-between">
                        <div class="logo" style="min-width: 446px;">
                            <a href="index.html" title="Home"><img src="https://lh3.googleusercontent.com/d/1HMoBG317n_Jg_aY8rgyUSYbzQjbbVLA3" alt="Brasão da A.M.J.J.K" style="max-height: 130px;"></a>
                        </div>
                        <div class="top-contact-info d-flex align-items-center">
                            <a href="#" data-toggle="tooltip" data-placement="bottom" target="_blank" title="Localização">
                                <i class="fa fa-map-marker" aria-hidden="true"></i> <span>Jardim John Kennedy, Ibiporã - PR, Brasil</span>
                            </a>
                            <a href="https://wa.me/554399597429" data-toggle="tooltip" data-placement="bottom" target="_blank" title="Fale conosco" style="min-width: 136px;">
                                <i class="fa fa-whatsapp" aria-hidden="true"></i> <span>(43) 99959-7429</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="credit-main-menu" id="sticker">
            <div class="classy-nav-container breakpoint-off">
                <div class="container">
                    <nav class="classy-navbar justify-content-between" id="creditNav">
                        <div class="classy-navbar-toggler">
                            <span class="navbarToggler"><span></span><span></span><span></span></span>
                        </div>
                        <div class="classy-menu">
                            <div class="classycloseIcon">
                                <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
                            </div>
                            <div class="classynav">
                                <ul>
                                    <li><a href="index.html" target="_self" title="HOME">HOME</a></li>
                                    <li><a href="galeria.html" target="_self" title="Galeria de Fotos">GALERIA</a></li>
                                    <li><a href="bairro.html" target="_self" title="História do Bairro">O BAIRRO</a></li>
                                    <li><a href="noticias.html" target="_self" title="NOTÍCIAS">NOTÍCIAS</a></li>
                                    <li><a href="servicos.html" target="_self" title="SERVIÇOS E UTILIDADES">SERVIÇOS</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="contact">
                            <a href="admin.html" class="btn associado-btn mt-20" target="_blank" title="admin"><i class="fa fa-address-card"></i> Adm</a>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <main>
        <section class="breadcrumb-area bg-img bg-overlay jarallax" style="background-image: url(img/bg-img/7.jpg);">
            <div class="container h-100">
                <div class="row h-100 align-items-center">
                    <div class="col-12">
                        <div class="breadcrumb-content text-center">
                            <h2 class="page-title">Nossa Diretoria</h2>
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb justify-content-center">
                                    <li class="breadcrumb-item"><a href="index.html"><i class="fa fa-home"></i> Home</a></li>
                                    <li class="breadcrumb-item active" aria-current="page">Diretoria</li>
                                </ol>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="about-area section-padding-100-0">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <div class="section-heading">
                            <div class="line"></div>
                            <p>Conheça</p>
                            <h2 id="gestao-titulo">Membros da Diretoria</h2>
                        </div>
                    </div>
                </div>
                
                <div class="row" id="diretoria-container">
                    <div class="col-12">
                        <p>Carregando membros...</p>
                    </div>
                </div>
                </div>
        </section>
        </main>
    
    <footer class="footer-area wow fadeInUp" data-wow-delay="200ms">
        <div class="copywrite-area"> <div class="container"> <div class="row"> <div class="col-12"> <p class="copywrite-text"> <a href="#" target="_blank" title="Como chegar">Jardim John Kennedy - Ibiporã - PR, Brasil</a> </p> </div> </div> <div class="row"> <div class="col-12"> <ul class="copywrite-text"> <li><a href="https://www.instagram.com/a.m.j_johnkennedy/?__pwa=1#" target="_blank" title="Instagram"><i class="fa fa-2x fa-instagram"></i></a></li> <li><a href="https://wa.me/554399597429" target="_blank" title="Whatsapp"><i class="fa fa-2x fa-whatsapp"></i></a></li> </ul> </div> </div> <div class="row"> <div class="col-12"> <p class="copywrite-text" style="color: white; opacity: 0.7; font-size: 0.9rem;"> Desenvolvido por: A.Yoshi </p> </div> </div> </div> </div>
    </footer>
    <link rel="stylesheet" href="css/boxwhatsapp.css">
    <div class="wptwa-container wptwa-round-toggle-on-mobile wptwa-mobile-center wptwa-show" data-delay-time="0" data-inactive-time="0" data-scroll-length="0"> <div class="wptwa-box wptwa-js-ready" id="ocultardiv"> <div class="wptwa-description"> <p>Oi, tudo bem? Clique abaixo para conversar conosco pelo WhatsApp.</p> </div> <span class="wptwa-close"></span> <div class="wptwa-people" style="max-height: 775px;"> <a href="https://wa.me/554399597429&text=Oi, tudo bem? Peguei esse WhatsApp no site." data-number="554399597429" class="wptwa-account wptwa-clearfix wptwa-no-image" data-auto-text="Oi, tudo bem? Peguei esse WhatsApp no site." data-ga-label="RECEPÇÃO" target="_blank"> <div class="wptwa-face no-image"> <img src="images/logogreenwhatsapp.png" /> </div> <div class="wptwa-info"> <span class="wptwa-title">A.M.J.J.K.</span> <span class="wptwa-name">Atendimento</span> </div> </a> </div> </div> <div class="wptwa-toggle"> <span><i class="fa fa-whatsapp"></i> Vamos conversar no WhatsApp?</span> </div> </div> <script> (function ($) { $(".wptwa-close").click(function(){ $(".wptwa-box").fadeOut("slow"); }); $(".wptwa-toggle").click(function(){ $(".wptwa-box").fadeIn("slow"); }); })(jQuery); </script>
    
    <script src="js/jquery/jquery-2.2.4.min.js"></script>
    <script src="js/bootstrap/popper.min.js"></script>
    <script src="js/bootstrap/bootstrap.min.js"></script>
    <script src="js/plugins/plugins.js"></script>
    <script src="js/active.js"></script>

    <script type="module">
        // Importar funções do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

        // SUA CONFIGURAÇÃO
        const firebaseConfig = {
            apiKey: "AIzaSyCAFbFIqzXC6qxgTWT6Mb5QNB-6ExCKswk",
            authDomain: "assoc-jjk.firebaseapp.com",
            projectId: "assoc-jjk",
            storageBucket: "assoc-jjk.firebasestorage.app",
            messagingSenderId: "912241957819",
            appId: "1:912241957819:web:91b11ec9aabf302717c29e",
            databaseURL: "https://assoc-jjk-default-rtdb.firebaseio.com"
        };
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // --- ORDEM DE CARGOS (Corrigida) ---
        const roleOrder = [
            "Presidente",
            "Vice-Presidente",
            "1º Secretário",
            "2º Secretário",
            "Tesoureiro",
            "Conselho Fiscal",
            "Suplente",
            "Associado",
            "Colaborador"
        ];
        
        function getRoleSortKey(role = '') {
            const cargoBase = role.split(' ')[0]; // Pega "Conselho" de "Conselho Fiscal"
            const index = roleOrder.indexOf(cargoBase);
            return (index !== -1) ? index : 99; // Joga cargos desconhecidos para o final
        }

        // Referência do HTML
        const container = document.getElementById('diretoria-container');
        const gestaoTitulo = document.getElementById('gestao-titulo');
        
        // 1. Puxa a Data da Gestão
        const dbRefGestao = ref(database, 'paginas/diretoria_gestao');
        onValue(dbRefGestao, (snapshot) => {
            const gestaoTexto = snapshot.val() || "";
            if(gestaoTexto) {
                gestaoTitulo.innerText = `Membros da Diretoria (${gestaoTexto})`;
            }
        });

        // 2. Puxa os Membros
        const dbRefDiretoria = ref(database, 'diretoria');
        onValue(dbRefDiretoria, (snapshot) => {
            container.innerHTML = ''; // Limpa a área
            
            if (snapshot.exists()) {
                let membrosHtml = '';
                let membrosArray = [];
                
                snapshot.forEach((childSnapshot) => {
                    membrosArray.push(childSnapshot.val());
                });

                // --- ORDENAÇÃO POR CARGO ---
                membrosArray.sort((a, b) => {
                    const cargoA = getRoleSortKey(a.cargo);
                    const cargoB = getRoleSortKey(b.cargo);
                    
                    if (cargoA === cargoB) {
                        // Se o cargo for o mesmo (ex: 2 Fiscais), ordena por nome
                        return (a.nome || '').localeCompare(b.nome || '');
                    }
                    return cargoA - cargoB; // Ordena pelo índice do cargo
                });

                // Constrói o HTML com os membros ordenados
                membrosArray.forEach((membro) => {
                    const fotoUrl = membro.imageUrl || 'https://via.placeholder.com/200x250.png?text=3x4';
                    const descricaoHtml = (membro.descricao || '').replace(/\n/g, '<br>');
                    
                    membrosHtml += `
                        <div class="col-12 col-md-6">
                            <div class="about-content-area mb-100 wow fadeInUp" data-wow-delay="100ms">
                                
                                <img src="${fotoUrl}" alt="${membro.nome}" class="mb-30 img-fluid" style="max-width: 200px; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                                
                                <h5 style="font-size: 1.4rem;">${membro.nome}</h5>
                                <p style="font-size: 1.1rem; line-height: 1.7;">
                                    <strong>Cargo:</strong> ${membro.cargo}<br>
                                    ${descricaoHtml ? `<strong>Descrição:</strong> ${descricaoHtml}<br>` : ''}
                                </p>
                                ${membro.instagram ? `<a href="${membro.instagram}" class="btn credit-btn btn-sm mt-3" target="_blank" style="background: #c13584; color: white;"><i class="fa fa-instagram"></i> Instagram</a>` : ''}
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = membrosHtml;

            } else {
                container.innerHTML = '<p class="col-12">Nenhum membro da diretoria cadastrado no momento.</p>';
            }
        }, (error) => {
            console.error("Erro ao carregar diretoria:", error);
            container.innerHTML = '<p class="col-12" style="color:red;">Erro ao carregar dados. Verifique as Regras de Leitura do Firebase.</p>';
        });
    </script>
</body>
</html>
